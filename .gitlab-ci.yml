stable:cargo:
  image: rustdocker/rust:stable
  stage: test
  script:
    - free -h
    - lscpu
    - cargo check --verbose
    - cargo test --verbose --jobs 1
    - cargo build --release
    - cargo build
    - cargo doc
    - cargo fmt --all -- --check

terraform:
  image: hashicorp/terraform:light
  stage: test
  script:
    - terraform -chdir=infra init
    - terraform -chdir=infra fmt --check
    - terraform -chdir=infra validate